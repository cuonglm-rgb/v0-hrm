{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/Pamo/v0-hrm/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from \"@supabase/ssr\"\r\nimport { cookies } from \"next/headers\"\r\n\r\nexport async function createClient() {\r\n  const cookieStore = await cookies()\r\n\r\n  return createServerClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!, {\r\n    cookies: {\r\n      getAll() {\r\n        return cookieStore.getAll()\r\n      },\r\n      setAll(cookiesToSet) {\r\n        try {\r\n          cookiesToSet.forEach(({ name, value, options }) => cookieStore.set(name, value, options))\r\n        } catch {\r\n          // The \"setAll\" method was called from a Server Component.\r\n          // This can be ignored if you have proxy refreshing user sessions.\r\n        }\r\n      },\r\n    },\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,0QAAO;IAEjC,OAAO,IAAA,4SAAkB,oKAAoF;QAC3G,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAAK,YAAY,GAAG,CAAC,MAAM,OAAO;gBAClF,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,kEAAkE;gBACpE;YACF;QACF;IACF;AACF"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///E:/Pamo/v0-hrm/lib/actions/employee-actions.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { createClient } from \"@/lib/supabase/server\"\r\nimport { revalidatePath } from \"next/cache\"\r\nimport type { Employee, EmployeeWithRelations, UserRoleWithRelations } from \"@/lib/types/database\"\r\n\r\nexport async function getMyEmployee(): Promise<EmployeeWithRelations | null> {\r\n  const supabase = await createClient()\r\n\r\n  const {\r\n    data: { user },\r\n  } = await supabase.auth.getUser()\r\n  if (!user) return null\r\n\r\n  const { data, error } = await supabase\r\n    .from(\"employees\")\r\n    .select(`\r\n      *,\r\n      department:departments(*),\r\n      position:positions(*),\r\n      manager:employees!manager_id(id, full_name, email)\r\n    `)\r\n    .eq(\"user_id\", user.id)\r\n    .single()\r\n\r\n  if (error) {\r\n    console.error(\"Error fetching employee:\", error)\r\n    return null\r\n  }\r\n\r\n  return data as EmployeeWithRelations\r\n}\r\n\r\nexport async function getMyRoles(): Promise<UserRoleWithRelations[]> {\r\n  const supabase = await createClient()\r\n\r\n  const {\r\n    data: { user },\r\n  } = await supabase.auth.getUser()\r\n  if (!user) return []\r\n\r\n  const { data, error } = await supabase\r\n    .from(\"user_roles\")\r\n    .select(`\r\n      *,\r\n      role:roles(*)\r\n    `)\r\n    .eq(\"user_id\", user.id)\r\n\r\n  if (error) {\r\n    console.error(\"Error fetching roles:\", error)\r\n    return []\r\n  }\r\n\r\n  return (data || []) as UserRoleWithRelations[]\r\n}\r\n\r\nexport async function listEmployees(): Promise<EmployeeWithRelations[]> {\r\n  const supabase = await createClient()\r\n\r\n  const { data, error } = await supabase\r\n    .from(\"employees\")\r\n    .select(`\r\n      *,\r\n      department:departments(*),\r\n      position:positions(*)\r\n    `)\r\n    .order(\"created_at\", { ascending: false })\r\n\r\n  if (error) {\r\n    console.error(\"Error listing employees:\", error)\r\n    return []\r\n  }\r\n\r\n  return (data || []) as EmployeeWithRelations[]\r\n}\r\n\r\nexport async function getEmployee(id: string): Promise<EmployeeWithRelations | null> {\r\n  const supabase = await createClient()\r\n\r\n  const { data, error } = await supabase\r\n    .from(\"employees\")\r\n    .select(`\r\n      *,\r\n      department:departments(*),\r\n      position:positions(*),\r\n      manager:employees!manager_id(id, full_name, email)\r\n    `)\r\n    .eq(\"id\", id)\r\n    .single()\r\n\r\n  if (error) {\r\n    console.error(\"Error fetching employee:\", error)\r\n    return null\r\n  }\r\n\r\n  return data as EmployeeWithRelations\r\n}\r\n\r\nexport async function updateEmployee(\r\n  id: string,\r\n  data: Partial<Pick<Employee, \"full_name\" | \"phone\" | \"department_id\" | \"position_id\" | \"status\" | \"join_date\">>,\r\n) {\r\n  const supabase = await createClient()\r\n\r\n  const { error } = await supabase\r\n    .from(\"employees\")\r\n    .update({ ...data, updated_at: new Date().toISOString() })\r\n    .eq(\"id\", id)\r\n\r\n  if (error) {\r\n    console.error(\"Error updating employee:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n\r\n  revalidatePath(\"/dashboard/employees\")\r\n  revalidatePath(`/dashboard/employees/${id}`)\r\n  return { success: true }\r\n}\r\n\r\nexport async function updateMyProfile(data: Partial<Pick<Employee, \"full_name\" | \"phone\">>) {\r\n  const supabase = await createClient()\r\n\r\n  const {\r\n    data: { user },\r\n  } = await supabase.auth.getUser()\r\n  if (!user) return { success: false, error: \"Not authenticated\" }\r\n\r\n  const { error } = await supabase\r\n    .from(\"employees\")\r\n    .update({ ...data, updated_at: new Date().toISOString() })\r\n    .eq(\"user_id\", user.id)\r\n\r\n  if (error) {\r\n    console.error(\"Error updating profile:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n\r\n  revalidatePath(\"/dashboard/profile\")\r\n  return { success: true }\r\n}\r\n\r\nexport async function createEmployee(data: {\r\n  full_name: string\r\n  email: string\r\n  phone?: string | null\r\n  department_id?: string | null\r\n  position_id?: string | null\r\n  join_date?: string | null\r\n}) {\r\n  const supabase = await createClient()\r\n\r\n  // Generate employee code\r\n  const code = `NV${new Date().toISOString().slice(0, 7).replace(\"-\", \"\")}${Math.floor(Math.random() * 10000)\r\n    .toString()\r\n    .padStart(4, \"0\")}`\r\n\r\n  const { error } = await supabase.from(\"employees\").insert({\r\n    employee_code: code,\r\n    full_name: data.full_name,\r\n    email: data.email,\r\n    phone: data.phone,\r\n    department_id: data.department_id,\r\n    position_id: data.position_id,\r\n    join_date: data.join_date,\r\n    status: \"onboarding\",\r\n  })\r\n\r\n  if (error) {\r\n    console.error(\"Error creating employee:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n\r\n  revalidatePath(\"/dashboard/employees\")\r\n  return { success: true }\r\n}\r\n\r\n// Đổi phòng ban + lưu lịch sử\r\nexport async function changeDepartment(\r\n  employeeId: string,\r\n  newDepartmentId: string,\r\n  salary?: number\r\n) {\r\n  const supabase = await createClient()\r\n\r\n  // Lấy thông tin hiện tại\r\n  const { data: employee } = await supabase\r\n    .from(\"employees\")\r\n    .select(\"department_id, position_id\")\r\n    .eq(\"id\", employeeId)\r\n    .single()\r\n\r\n  if (!employee) return { success: false, error: \"Employee not found\" }\r\n\r\n  const today = new Date().toISOString().split(\"T\")[0]\r\n\r\n  // Đóng record lịch sử cũ\r\n  await supabase\r\n    .from(\"employee_job_history\")\r\n    .update({ end_date: today })\r\n    .eq(\"employee_id\", employeeId)\r\n    .is(\"end_date\", null)\r\n\r\n  // Tạo record lịch sử mới\r\n  await supabase.from(\"employee_job_history\").insert({\r\n    employee_id: employeeId,\r\n    department_id: newDepartmentId,\r\n    position_id: employee.position_id,\r\n    salary: salary || null,\r\n    start_date: today,\r\n  })\r\n\r\n  // Update employee\r\n  const { error } = await supabase\r\n    .from(\"employees\")\r\n    .update({ department_id: newDepartmentId, updated_at: new Date().toISOString() })\r\n    .eq(\"id\", employeeId)\r\n\r\n  if (error) {\r\n    console.error(\"Error changing department:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n\r\n  revalidatePath(\"/dashboard/employees\")\r\n  revalidatePath(`/dashboard/employees/${employeeId}`)\r\n  return { success: true }\r\n}\r\n\r\n// Đổi chức vụ + lưu lịch sử\r\nexport async function changePosition(\r\n  employeeId: string,\r\n  newPositionId: string,\r\n  salary?: number\r\n) {\r\n  const supabase = await createClient()\r\n\r\n  // Lấy thông tin hiện tại\r\n  const { data: employee } = await supabase\r\n    .from(\"employees\")\r\n    .select(\"department_id, position_id\")\r\n    .eq(\"id\", employeeId)\r\n    .single()\r\n\r\n  if (!employee) return { success: false, error: \"Employee not found\" }\r\n\r\n  const today = new Date().toISOString().split(\"T\")[0]\r\n\r\n  // Đóng record lịch sử cũ\r\n  await supabase\r\n    .from(\"employee_job_history\")\r\n    .update({ end_date: today })\r\n    .eq(\"employee_id\", employeeId)\r\n    .is(\"end_date\", null)\r\n\r\n  // Tạo record lịch sử mới\r\n  await supabase.from(\"employee_job_history\").insert({\r\n    employee_id: employeeId,\r\n    department_id: employee.department_id,\r\n    position_id: newPositionId,\r\n    salary: salary || null,\r\n    start_date: today,\r\n  })\r\n\r\n  // Update employee\r\n  const { error } = await supabase\r\n    .from(\"employees\")\r\n    .update({ position_id: newPositionId, updated_at: new Date().toISOString() })\r\n    .eq(\"id\", employeeId)\r\n\r\n  if (error) {\r\n    console.error(\"Error changing position:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n\r\n  revalidatePath(\"/dashboard/employees\")\r\n  revalidatePath(`/dashboard/employees/${employeeId}`)\r\n  return { success: true }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 292, "column": 0}, "map": {"version":3,"sources":["file:///E:/Pamo/v0-hrm/lib/actions/attendance-actions.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { createClient } from \"@/lib/supabase/server\"\r\nimport { revalidatePath } from \"next/cache\"\r\nimport type { AttendanceLog, AttendanceLogWithRelations } from \"@/lib/types/database\"\r\n\r\nexport async function getMyAttendance(from?: string, to?: string): Promise<AttendanceLog[]> {\r\n  const supabase = await createClient()\r\n\r\n  const { data: { user } } = await supabase.auth.getUser()\r\n  if (!user) return []\r\n\r\n  // Lấy employee_id của user\r\n  const { data: employee } = await supabase\r\n    .from(\"employees\")\r\n    .select(\"id\")\r\n    .eq(\"user_id\", user.id)\r\n    .single()\r\n\r\n  if (!employee) return []\r\n\r\n  let query = supabase\r\n    .from(\"attendance_logs\")\r\n    .select(\"*\")\r\n    .eq(\"employee_id\", employee.id)\r\n    .order(\"check_in\", { ascending: false })\r\n\r\n  if (from) query = query.gte(\"check_in\", from)\r\n  if (to) query = query.lte(\"check_in\", to)\r\n\r\n  const { data, error } = await query\r\n\r\n  if (error) {\r\n    console.error(\"Error fetching attendance:\", error)\r\n    return []\r\n  }\r\n\r\n  return data || []\r\n}\r\n\r\nexport async function checkIn() {\r\n  const supabase = await createClient()\r\n\r\n  const { data: { user } } = await supabase.auth.getUser()\r\n  if (!user) return { success: false, error: \"Not authenticated\" }\r\n\r\n  const { data: employee } = await supabase\r\n    .from(\"employees\")\r\n    .select(\"id\")\r\n    .eq(\"user_id\", user.id)\r\n    .single()\r\n\r\n  if (!employee) return { success: false, error: \"Employee not found\" }\r\n\r\n  // Kiểm tra đã check-in hôm nay chưa\r\n  const today = new Date().toISOString().split(\"T\")[0]\r\n  const { data: existing } = await supabase\r\n    .from(\"attendance_logs\")\r\n    .select(\"id\")\r\n    .eq(\"employee_id\", employee.id)\r\n    .gte(\"check_in\", today)\r\n    .lt(\"check_in\", today + \"T23:59:59\")\r\n    .single()\r\n\r\n  if (existing) {\r\n    return { success: false, error: \"Already checked in today\" }\r\n  }\r\n\r\n  const { error } = await supabase.from(\"attendance_logs\").insert({\r\n    employee_id: employee.id,\r\n    check_in: new Date().toISOString(),\r\n    source: \"manual\",\r\n  })\r\n\r\n  if (error) {\r\n    console.error(\"Error checking in:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n\r\n  revalidatePath(\"/dashboard/attendance\")\r\n  return { success: true }\r\n}\r\n\r\nexport async function checkOut() {\r\n  const supabase = await createClient()\r\n\r\n  const { data: { user } } = await supabase.auth.getUser()\r\n  if (!user) return { success: false, error: \"Not authenticated\" }\r\n\r\n  const { data: employee } = await supabase\r\n    .from(\"employees\")\r\n    .select(\"id\")\r\n    .eq(\"user_id\", user.id)\r\n    .single()\r\n\r\n  if (!employee) return { success: false, error: \"Employee not found\" }\r\n\r\n  // Tìm record check-in hôm nay\r\n  const today = new Date().toISOString().split(\"T\")[0]\r\n  const { data: attendance } = await supabase\r\n    .from(\"attendance_logs\")\r\n    .select(\"id, check_out\")\r\n    .eq(\"employee_id\", employee.id)\r\n    .gte(\"check_in\", today)\r\n    .lt(\"check_in\", today + \"T23:59:59\")\r\n    .single()\r\n\r\n  if (!attendance) {\r\n    return { success: false, error: \"No check-in record found for today\" }\r\n  }\r\n\r\n  if (attendance.check_out) {\r\n    return { success: false, error: \"Already checked out today\" }\r\n  }\r\n\r\n  const { error } = await supabase\r\n    .from(\"attendance_logs\")\r\n    .update({ check_out: new Date().toISOString() })\r\n    .eq(\"id\", attendance.id)\r\n\r\n  if (error) {\r\n    console.error(\"Error checking out:\", error)\r\n    return { success: false, error: error.message }\r\n  }\r\n\r\n  revalidatePath(\"/dashboard/attendance\")\r\n  return { success: true }\r\n}\r\n\r\nexport async function listAttendance(filters?: {\r\n  employee_id?: string\r\n  from?: string\r\n  to?: string\r\n}): Promise<AttendanceLogWithRelations[]> {\r\n  const supabase = await createClient()\r\n\r\n  let query = supabase\r\n    .from(\"attendance_logs\")\r\n    .select(`*, employee:employees(id, full_name, employee_code)`)\r\n    .order(\"check_in\", { ascending: false })\r\n\r\n  if (filters?.employee_id) query = query.eq(\"employee_id\", filters.employee_id)\r\n  if (filters?.from) query = query.gte(\"check_in\", filters.from)\r\n  if (filters?.to) query = query.lte(\"check_in\", filters.to)\r\n\r\n  const { data, error } = await query.limit(100)\r\n\r\n  if (error) {\r\n    console.error(\"Error listing attendance:\", error)\r\n    return []\r\n  }\r\n\r\n  return (data || []) as AttendanceLogWithRelations[]\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;AAEA;AACA;;;;;AAGO,eAAe,gBAAgB,IAAa,EAAE,EAAW;IAC9D,MAAM,WAAW,MAAM,IAAA,yIAAY;IAEnC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACtD,IAAI,CAAC,MAAM,OAAO,EAAE;IAEpB,2BAA2B;IAC3B,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,SAC9B,IAAI,CAAC,aACL,MAAM,CAAC,MACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,MAAM;IAET,IAAI,CAAC,UAAU,OAAO,EAAE;IAExB,IAAI,QAAQ,SACT,IAAI,CAAC,mBACL,MAAM,CAAC,KACP,EAAE,CAAC,eAAe,SAAS,EAAE,EAC7B,KAAK,CAAC,YAAY;QAAE,WAAW;IAAM;IAExC,IAAI,MAAM,QAAQ,MAAM,GAAG,CAAC,YAAY;IACxC,IAAI,IAAI,QAAQ,MAAM,GAAG,CAAC,YAAY;IAEtC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;IAE9B,IAAI,OAAO;QACT,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,EAAE;IACX;IAEA,OAAO,QAAQ,EAAE;AACnB;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,IAAA,yIAAY;IAEnC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACtD,IAAI,CAAC,MAAM,OAAO;QAAE,SAAS;QAAO,OAAO;IAAoB;IAE/D,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,SAC9B,IAAI,CAAC,aACL,MAAM,CAAC,MACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,MAAM;IAET,IAAI,CAAC,UAAU,OAAO;QAAE,SAAS;QAAO,OAAO;IAAqB;IAEpE,oCAAoC;IACpC,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IACpD,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,SAC9B,IAAI,CAAC,mBACL,MAAM,CAAC,MACP,EAAE,CAAC,eAAe,SAAS,EAAE,EAC7B,GAAG,CAAC,YAAY,OAChB,EAAE,CAAC,YAAY,QAAQ,aACvB,MAAM;IAET,IAAI,UAAU;QACZ,OAAO;YAAE,SAAS;YAAO,OAAO;QAA2B;IAC7D;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,mBAAmB,MAAM,CAAC;QAC9D,aAAa,SAAS,EAAE;QACxB,UAAU,IAAI,OAAO,WAAW;QAChC,QAAQ;IACV;IAEA,IAAI,OAAO;QACT,QAAQ,KAAK,CAAC,sBAAsB;QACpC,OAAO;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC;IAChD;IAEA,IAAA,+QAAc,EAAC;IACf,OAAO;QAAE,SAAS;IAAK;AACzB;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,IAAA,yIAAY;IAEnC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IACtD,IAAI,CAAC,MAAM,OAAO;QAAE,SAAS;QAAO,OAAO;IAAoB;IAE/D,MAAM,EAAE,MAAM,QAAQ,EAAE,GAAG,MAAM,SAC9B,IAAI,CAAC,aACL,MAAM,CAAC,MACP,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,MAAM;IAET,IAAI,CAAC,UAAU,OAAO;QAAE,SAAS;QAAO,OAAO;IAAqB;IAEpE,8BAA8B;IAC9B,MAAM,QAAQ,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;IACpD,MAAM,EAAE,MAAM,UAAU,EAAE,GAAG,MAAM,SAChC,IAAI,CAAC,mBACL,MAAM,CAAC,iBACP,EAAE,CAAC,eAAe,SAAS,EAAE,EAC7B,GAAG,CAAC,YAAY,OAChB,EAAE,CAAC,YAAY,QAAQ,aACvB,MAAM;IAET,IAAI,CAAC,YAAY;QACf,OAAO;YAAE,SAAS;YAAO,OAAO;QAAqC;IACvE;IAEA,IAAI,WAAW,SAAS,EAAE;QACxB,OAAO;YAAE,SAAS;YAAO,OAAO;QAA4B;IAC9D;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,mBACL,MAAM,CAAC;QAAE,WAAW,IAAI,OAAO,WAAW;IAAG,GAC7C,EAAE,CAAC,MAAM,WAAW,EAAE;IAEzB,IAAI,OAAO;QACT,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC;IAChD;IAEA,IAAA,+QAAc,EAAC;IACf,OAAO;QAAE,SAAS;IAAK;AACzB;AAEO,eAAe,eAAe,OAIpC;IACC,MAAM,WAAW,MAAM,IAAA,yIAAY;IAEnC,IAAI,QAAQ,SACT,IAAI,CAAC,mBACL,MAAM,CAAC,CAAC,mDAAmD,CAAC,EAC5D,KAAK,CAAC,YAAY;QAAE,WAAW;IAAM;IAExC,IAAI,SAAS,aAAa,QAAQ,MAAM,EAAE,CAAC,eAAe,QAAQ,WAAW;IAC7E,IAAI,SAAS,MAAM,QAAQ,MAAM,GAAG,CAAC,YAAY,QAAQ,IAAI;IAC7D,IAAI,SAAS,IAAI,QAAQ,MAAM,GAAG,CAAC,YAAY,QAAQ,EAAE;IAEzD,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,MAAM,KAAK,CAAC;IAE1C,IAAI,OAAO;QACT,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,EAAE;IACX;IAEA,OAAQ,QAAQ,EAAE;AACpB;;;IAnJsB;IAkCA;IA2CA;IA8CA;;AA3HA,+WAAA;AAkCA,+WAAA;AA2CA,+WAAA;AA8CA,+WAAA"}},
    {"offset": {"line": 438, "column": 0}, "map": {"version":3,"sources":["file:///E:/Pamo/v0-hrm/lib/actions/attendance-import-actions.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { createClient } from \"@/lib/supabase/server\"\r\nimport { revalidatePath } from \"next/cache\"\r\nimport * as XLSX from \"xlsx\"\r\n\r\ninterface ImportResult {\r\n  success: boolean\r\n  total: number\r\n  imported: number\r\n  skipped: number\r\n  errors: string[]\r\n}\r\n\r\n/**\r\n * Import chấm công từ file Excel\r\n * Format file:\r\n * | Mã N.Viên | Tên nhân viên | Phòng ban | Ngày | Thứ | Vào | Ra |\r\n * | NV001     | Nguyễn Văn A  | IT        | 01   | T2  | 08:30 | 17:30 |\r\n */\r\nexport async function importAttendanceFromExcel(\r\n  formData: FormData\r\n): Promise<ImportResult> {\r\n  const supabase = await createClient()\r\n\r\n  const file = formData.get(\"file\") as File\r\n  const monthYear = formData.get(\"monthYear\") as string // Format: \"2025-11\"\r\n\r\n  if (!file) {\r\n    return { success: false, total: 0, imported: 0, skipped: 0, errors: [\"Không có file\"] }\r\n  }\r\n\r\n  if (!monthYear) {\r\n    return { success: false, total: 0, imported: 0, skipped: 0, errors: [\"Chưa chọn tháng/năm\"] }\r\n  }\r\n\r\n  const [year, month] = monthYear.split(\"-\").map(Number)\r\n\r\n  try {\r\n    // Đọc file Excel\r\n    const buffer = await file.arrayBuffer()\r\n    const workbook = XLSX.read(buffer, { type: \"array\" })\r\n    const sheetName = workbook.SheetNames[0]\r\n    const worksheet = workbook.Sheets[sheetName]\r\n\r\n    // Chuyển đổi sang JSON\r\n    const rawData = XLSX.utils.sheet_to_json(worksheet, { header: 1 }) as unknown[][]\r\n\r\n    if (rawData.length < 2) {\r\n      return { success: false, total: 0, imported: 0, skipped: 0, errors: [\"File rỗng hoặc không có dữ liệu\"] }\r\n    }\r\n\r\n    // Bỏ header row\r\n    const dataRows = rawData.slice(1)\r\n    const errors: string[] = []\r\n    let imported = 0\r\n    let skipped = 0\r\n\r\n    // Lấy danh sách employee để map employee_code -> id\r\n    const { data: employees } = await supabase\r\n      .from(\"employees\")\r\n      .select(\"id, employee_code\")\r\n\r\n    const employeeMap = new Map(\r\n      employees?.map((e) => [e.employee_code?.toLowerCase().trim(), e.id]) || []\r\n    )\r\n\r\n    for (let i = 0; i < dataRows.length; i++) {\r\n      const row = dataRows[i]\r\n      const rowNum = i + 2 // +2 vì bỏ header và index từ 0\r\n\r\n      // Kiểm tra row có đủ dữ liệu không\r\n      if (!row || row.length < 6) {\r\n        skipped++\r\n        continue\r\n      }\r\n\r\n      // Format: Mã N.Viên | Tên nhân viên | Phòng ban | Ngày | Thứ | Vào | Ra\r\n      const employeeCode = String(row[0] || \"\").trim().toLowerCase()\r\n      // row[1] = Tên nhân viên (bỏ qua, dùng để đối chiếu)\r\n      // row[2] = Phòng ban (bỏ qua)\r\n      const dayValue = row[3] // Ngày trong tháng (1-31)\r\n      // row[4] = Thứ (bỏ qua)\r\n      const checkInValue = row[5] // Giờ vào\r\n      const checkOutValue = row[6] // Giờ ra\r\n\r\n      // Validate employee_code\r\n      if (!employeeCode) {\r\n        skipped++\r\n        continue\r\n      }\r\n\r\n      const employeeId = employeeMap.get(employeeCode)\r\n      if (!employeeId) {\r\n        errors.push(`Dòng ${rowNum}: Không tìm thấy nhân viên \"${row[0]}\"`)\r\n        skipped++\r\n        continue\r\n      }\r\n\r\n      // Parse ngày\r\n      let day: number\r\n      if (typeof dayValue === \"number\") {\r\n        day = Math.floor(dayValue)\r\n      } else {\r\n        day = parseInt(String(dayValue || \"\").trim(), 10)\r\n      }\r\n\r\n      if (isNaN(day) || day < 1 || day > 31) {\r\n        errors.push(`Dòng ${rowNum}: Ngày không hợp lệ \"${dayValue}\"`)\r\n        skipped++\r\n        continue\r\n      }\r\n\r\n      // Tạo date string\r\n      const dateStr = `${year}-${String(month).padStart(2, \"0\")}-${String(day).padStart(2, \"0\")}`\r\n\r\n      // Validate ngày hợp lệ trong tháng\r\n      const testDate = new Date(year, month - 1, day)\r\n      if (testDate.getMonth() !== month - 1) {\r\n        errors.push(`Dòng ${rowNum}: Ngày ${day} không tồn tại trong tháng ${month}`)\r\n        skipped++\r\n        continue\r\n      }\r\n\r\n      // Parse giờ vào\r\n      const checkInTime = parseTimeValue(checkInValue)\r\n      if (!checkInTime) {\r\n        // Không có giờ vào thì bỏ qua dòng này\r\n        skipped++\r\n        continue\r\n      }\r\n\r\n      // Parse giờ ra (optional)\r\n      const checkOutTime = parseTimeValue(checkOutValue)\r\n\r\n      // Tạo timestamp với múi giờ VN (+07:00)\r\n      const checkInTimestamp = `${dateStr}T${checkInTime}:00+07:00`\r\n      const checkOutTimestamp = checkOutTime ? `${dateStr}T${checkOutTime}:00+07:00` : null\r\n\r\n      // Kiểm tra đã có record cho ngày này chưa\r\n      const { data: existing } = await supabase\r\n        .from(\"attendance_logs\")\r\n        .select(\"id\")\r\n        .eq(\"employee_id\", employeeId)\r\n        .gte(\"check_in\", `${dateStr}T00:00:00`)\r\n        .lt(\"check_in\", `${dateStr}T23:59:59`)\r\n        .single()\r\n\r\n      if (existing) {\r\n        // Update record hiện có\r\n        const { error } = await supabase\r\n          .from(\"attendance_logs\")\r\n          .update({\r\n            check_in: checkInTimestamp,\r\n            check_out: checkOutTimestamp,\r\n            source: \"import\",\r\n          })\r\n          .eq(\"id\", existing.id)\r\n\r\n        if (error) {\r\n          errors.push(`Dòng ${rowNum}: Lỗi cập nhật - ${error.message}`)\r\n          skipped++\r\n        } else {\r\n          imported++\r\n        }\r\n      } else {\r\n        // Insert record mới\r\n        const { error } = await supabase.from(\"attendance_logs\").insert({\r\n          employee_id: employeeId,\r\n          check_in: checkInTimestamp,\r\n          check_out: checkOutTimestamp,\r\n          source: \"import\",\r\n        })\r\n\r\n        if (error) {\r\n          errors.push(`Dòng ${rowNum}: Lỗi thêm mới - ${error.message}`)\r\n          skipped++\r\n        } else {\r\n          imported++\r\n        }\r\n      }\r\n    }\r\n\r\n    revalidatePath(\"/dashboard/attendance\")\r\n    revalidatePath(\"/dashboard/attendance-management\")\r\n\r\n    return {\r\n      success: true,\r\n      total: dataRows.length,\r\n      imported,\r\n      skipped,\r\n      errors: errors.slice(0, 10), // Giới hạn 10 lỗi đầu\r\n    }\r\n  } catch (error) {\r\n    console.error(\"Error importing attendance:\", error)\r\n    return {\r\n      success: false,\r\n      total: 0,\r\n      imported: 0,\r\n      skipped: 0,\r\n      errors: [`Lỗi đọc file: ${error instanceof Error ? error.message : \"Unknown error\"}`],\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Parse giá trị thời gian từ Excel\r\n * Hỗ trợ: \"08:30\", \"8:30\", 0.354166... (Excel time fraction)\r\n */\r\nfunction parseTimeValue(value: unknown): string | null {\r\n  if (value === null || value === undefined || value === \"\") {\r\n    return null\r\n  }\r\n\r\n  if (typeof value === \"number\") {\r\n    // Excel time fraction (0.0 = 00:00, 0.5 = 12:00, 1.0 = 24:00)\r\n    const totalMinutes = Math.round(value * 24 * 60)\r\n    const hours = Math.floor(totalMinutes / 60) % 24\r\n    const minutes = totalMinutes % 60\r\n    return `${String(hours).padStart(2, \"0\")}:${String(minutes).padStart(2, \"0\")}`\r\n  }\r\n\r\n  const timeStr = String(value).trim()\r\n  \r\n  // Match HH:mm or H:mm format\r\n  const match = timeStr.match(/^(\\d{1,2}):(\\d{2})(?::\\d{2})?$/)\r\n  if (match) {\r\n    const hours = parseInt(match[1], 10)\r\n    const minutes = parseInt(match[2], 10)\r\n    if (hours >= 0 && hours < 24 && minutes >= 0 && minutes < 60) {\r\n      return `${String(hours).padStart(2, \"0\")}:${String(minutes).padStart(2, \"0\")}`\r\n    }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\n/**\r\n * Tạo file Excel mẫu để download\r\n */\r\nexport async function generateAttendanceTemplate(): Promise<{\r\n  success: boolean\r\n  data?: string\r\n  error?: string\r\n}> {\r\n  try {\r\n    const supabase = await createClient()\r\n\r\n    // Lấy danh sách nhân viên active với phòng ban\r\n    const { data: employees } = await supabase\r\n      .from(\"employees\")\r\n      .select(\"employee_code, full_name, departments(name)\")\r\n      .eq(\"status\", \"active\")\r\n      .order(\"employee_code\")\r\n\r\n    // Tạo workbook\r\n    const wb = XLSX.utils.book_new()\r\n\r\n    // Sheet 1: Template với format mới\r\n    const templateData = [\r\n      [\"Mã N.Viên\", \"Tên nhân viên\", \"Phòng ban\", \"Ngày\", \"Thứ\", \"Vào\", \"Ra\"],\r\n      [\"NV001\", \"Nguyễn Văn A\", \"IT\", 1, \"T2\", \"08:30\", \"17:30\"],\r\n      [\"NV001\", \"Nguyễn Văn A\", \"IT\", 2, \"T3\", \"08:45\", \"17:45\"],\r\n      [\"NV002\", \"Trần Thị B\", \"HR\", 1, \"T2\", \"08:30\", \"17:30\"],\r\n    ]\r\n    const ws1 = XLSX.utils.aoa_to_sheet(templateData)\r\n\r\n    // Set column widths\r\n    ws1[\"!cols\"] = [\r\n      { wch: 12 }, // Mã N.Viên\r\n      { wch: 20 }, // Tên nhân viên\r\n      { wch: 15 }, // Phòng ban\r\n      { wch: 6 },  // Ngày\r\n      { wch: 5 },  // Thứ\r\n      { wch: 8 },  // Vào\r\n      { wch: 8 },  // Ra\r\n    ]\r\n\r\n    XLSX.utils.book_append_sheet(wb, ws1, \"Chấm công\")\r\n\r\n    // Sheet 2: Danh sách nhân viên\r\n    const employeeData: (string | null | undefined)[][] = [\r\n      [\"Mã N.Viên\", \"Tên nhân viên\", \"Phòng ban\"],\r\n      ...(employees?.map((e) => {\r\n        const dept = e.departments as { name: string } | null\r\n        return [e.employee_code, e.full_name, dept?.name || \"\"]\r\n      }) || []),\r\n    ]\r\n    const ws2 = XLSX.utils.aoa_to_sheet(employeeData)\r\n    ws2[\"!cols\"] = [{ wch: 12 }, { wch: 25 }, { wch: 20 }]\r\n    XLSX.utils.book_append_sheet(wb, ws2, \"Danh sách NV\")\r\n\r\n    // Xuất ra base64\r\n    const buffer = XLSX.write(wb, { type: \"base64\", bookType: \"xlsx\" })\r\n\r\n    return { success: true, data: buffer }\r\n  } catch (error) {\r\n    console.error(\"Error generating template:\", error)\r\n    return {\r\n      success: false,\r\n      error: error instanceof Error ? error.message : \"Unknown error\",\r\n    }\r\n  }\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 787, "column": 0}, "map": {"version":3,"sources":["file:///E:/Pamo/v0-hrm/.next-internal/server/app/dashboard/attendance-management/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getMyRoles as '005e20e2e268d812762b030e4aac3b7693066871b6'} from 'ACTIONS_MODULE0'\nexport {getMyEmployee as '00636a7c2e61bd285b975ea815e7fbbefdffae959f'} from 'ACTIONS_MODULE0'\nexport {listEmployees as '00b0c7f0352396833a3aa70b738bb3a8c2a485efae'} from 'ACTIONS_MODULE0'\nexport {createEmployee as '4072cdebcca1df607d08f62096843ddf91d2cf29f6'} from 'ACTIONS_MODULE0'\nexport {updateMyProfile as '407a7f2085358134fb9b61998dbd9fa880ad52c2cf'} from 'ACTIONS_MODULE0'\nexport {getEmployee as '409df3c5b25ea33596f872aab0b186da47271a8e80'} from 'ACTIONS_MODULE0'\nexport {updateEmployee as '60e7529b55507157f11112b5c625757ac226a23a7c'} from 'ACTIONS_MODULE0'\nexport {changeDepartment as '701419c868154523741dd2880ac65e97064ceb8620'} from 'ACTIONS_MODULE0'\nexport {changePosition as '70daddb01ea9f495d095baa024616ddfa6ee94f8dd'} from 'ACTIONS_MODULE0'\nexport {checkIn as '0044def5c4ae00c73cee8246f37e5c7f31cfa1b92b'} from 'ACTIONS_MODULE1'\nexport {checkOut as '00d6231afa02148cee00d77c2e86cbcfcacd6e0be0'} from 'ACTIONS_MODULE1'\nexport {listAttendance as '4040e9b328525a1ddf3e601b33e8a598a808f94e5e'} from 'ACTIONS_MODULE1'\nexport {getMyAttendance as '602bd54b668a505e0fd8670b012befb376511d9937'} from 'ACTIONS_MODULE1'\nexport {importAttendanceFromExcel as '40efdc6d340d852fbcc412cc3d9d5afe7f51004f7e'} from 'ACTIONS_MODULE2'\nexport {generateAttendanceTemplate as '00aef03935d9e0ba89c574d7a9a452079295fef6f9'} from 'ACTIONS_MODULE2'\n"],"names":[],"mappings":";AAAA;AASA;AAIA"}}]
}